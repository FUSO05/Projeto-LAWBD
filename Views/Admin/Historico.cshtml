@using System.Security.Claims
@model List<AutoMarket.Models.HistoricoAdmin>

@{
    ViewData["Title"] = "Histórico de Ações Administrativas";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

@section Styles {
    <link rel="stylesheet" href="~/css/admin.css" />
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
}

<style>

    /* --- Header --- */
    .form-header {
        background-color: #fff;
        border-radius: 12px;
        padding: 20px 25px;
        margin-bottom: 30px;
        box-shadow: 0 2px 10px rgba(0,0,0,0.05);
    }

    .header-content {
        display: flex;
        align-items: center;
        gap: 15px;
    }

        .header-content svg {
            stroke: #4f46e5; /* roxo suave */
            min-width: 40px;
            min-height: 40px;
        }

        .header-content h2 {
            margin: 0;
            font-size: 1.6rem;
            font-weight: 600;
            color: #111827;
        }

        .header-content p {
            margin: 2px 0 0;
            font-size: 0.95rem;
            color: #6b7280; /* cinza */
        }

    /* --- Tabela --- */
    .historico-container {
        background-color: #fff;
        border-radius: 12px;
        padding: 20px;
        box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        overflow-x: auto;
    }

        .historico-container table {
            width: 100%;
            border-collapse: collapse;
        }

        .historico-container th,
        .historico-container td {
            text-align: left;
            padding: 12px 15px;
        }

        .historico-container thead th {
            background-color: #4f46e5; /* roxo */
            color: #fff;
            font-weight: 600;
            text-transform: uppercase;
            font-size: 0.9rem;
        }

        .historico-container tbody tr {
            border-bottom: 1px solid #e5e7eb; /* cinza claro */
            transition: background 0.2s;
        }

            .historico-container tbody tr:nth-child(even) {
                background-color: #f9fafb; /* listras suaves */
            }

            .historico-container tbody tr:hover {
                background-color: #eef2ff; /* destaque ao passar mouse */
            }

    /* --- Links de paginação --- */
    .page-links {
        margin-top: 20px;
        text-align: center;
    }

        .page-links a {
            display: inline-block;
            margin: 0 5px;
            padding: 6px 12px;
            border-radius: 6px;
            background-color: #f3f4f6;
            color: #374151;
            font-weight: 500;
            text-decoration: none;
            transition: background 0.2s, color 0.2s;
        }

            .page-links a.active {
                background-color: #4f46e5;
                color: #fff;
            }

            .page-links a:hover:not(.active) {
                background-color: #e0e7ff;
            }

</style>

<main class="user-settings-container">
    @await Html.PartialAsync("_MenuAdmin")

    <section class="settings-form">
        <div class="form-header">
            <div class="header-content">
                <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="3" />
                    <path d="M12 1v6m0 6v6m5.196-13.804L15.392 7m-6.784 6.784l-1.804 1.804M23 12h-6m-6 0H5m13.804 5.196L17 15.392m-6.784-6.784L8.412 6.804" />
                </svg>
                <div>
                    <h2>Histórico de Ações Administrativas</h2>
                    <p>Visualize todas as ações realizadas pelos administradores</p>
                </div>
            </div>
        </div>

        <div class="historico-container">
            <table>
                <thead>
                    <tr>
                        <th>Data</th>
                        <th>Administrador</th>
                        <th>Ação</th>
                        <th>Utilizador Alvo</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var h in Model)
                    {
                        <tr>
                            <td>@h.DataAcao.ToString("dd/MM/yyyy HH:mm")</td>
                            <td>@h.Admin.Utilizador.Nome</td>
                            <td>@h.Acao</td>
                            <td>@h.UtilizadorAlvo?.Nome</td>
                        </tr>
                    }
                </tbody>
            </table>

            <div class="page-links">
                @for (int i = 1; i <= (ViewBag.TotalPages ?? 1); i++)
                {
                    <a href="@Url.Action("Historico", new { page = i })" class="@(i == (ViewBag.CurrentPage ?? 1) ? "active" : "")">@i</a>
                }
            </div>
        </div>
    </section>
</main>

@section Scripts {
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
</script>
}